FROM ubuntu:latest
MAINTAINER gens@balihoo.com

## upgrade all packages
RUN apt-get install -y software-properties-common
RUN add-apt-repository "deb http://archive.ubuntu.com/ubuntu $(lsb_release -sc) universe"
RUN add-apt-repository ppa:webupd8team/java
RUN apt-get update
RUN apt-get upgrade -y

## install supervisor
RUN apt-get install -y openssh-server apache2 supervisor
RUN mkdir -p /var/run/sshd
RUN mkdir -p /var/log/supervisor
ADD supervisord.conf /etc/supervisor/conf.d/supervisord.conf
EXPOSE 22 80
CMD ["/usr/bin/supervisord"]

# install java
#RUN apt-get install -y default-jdk #this is openjdk6 for precise, or 7 for trusty
#RUN apt-get install -y openjdk-7-jdk
RUN apt-get install -y python-software-properties
RUN echo "Y" | apt-get install -y oracle-java7-installer
RUN apt-get install -y oracle-java7-set-default

# install fulfillment app
RUN mkdir -p /opt/fulfillment/bin
ADD config /opt/fulfillment/bin/config
ADD fulfillment.jar /opt/fulfillment/bin/fulfillment.jar
ADD launch_fulfillment /opt/fulfillment/bin/launch_fulfillment
